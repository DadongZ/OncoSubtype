---
title: "mRNA Subtyping"
author: "Dadong Zhang"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{mRNA Subtyping}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# mlsubtyping

## Latest version

0.2.4
<!-- badges: start -->
<!-- badges: end -->

Provide functionality for cancer subtyping using existing published methods or machine learning based on TCGA data.

Currently support mRNA subtyping for LUSC, LUAD, HNSC, STAD, and BLCA using [nearest centroids method](https://clincancerres.aacrjournals.org/content/16/19/4864) or machine-learning-based method by training TCGA data.

## Installation

You can install the latest released version by

``` r
install.packages("mlsubtyping_0.2.4.tar.gz", repos = NULL, type="source")
```
Or
``` r
devtools::install_github("u1072932/mlsubtyping")
```
Or
``` r
R CMD INSTALL mlsubtyping_0.2.4.tar.gz
```
## Example

This is a basic example for predicting the subtypes for LUSC.

### Predict (Lung Squamous Cell Carcinoma) LUSC  mRNA Expression Subtypes using [wilkerson method](https://clincancerres.aacrjournals.org/content/16/19/4864)

```{r wilkerson, eval=FALSE}
library(mlsubtyping)
library(tidyverse)
set.seed(2121)
data <- get_median_centered(example_fpkm)
data <- assays(data)$centered
rownames(data) <- rowData(example_fpkm)$external_gene_name
# use default wilkerson's nearest centroids method
output1 <- CentroidsSubtype(data, disease = 'LUSC')
table(output1$subtypes)
```

### Using random forest model by training TCGA LUSC data
```{r rf, eval=FALSE}
output2 <- MLSubtype(data, disease = 'LUSC', method = 'rf')
table(output1$subtypes)
confusionMatrix(output1, output2)
```

### Check the consistance between two methods
```{r confusion, eval=FALSE}
confusionMatrix(output1, output2)
```

### Plotheat map
```{r heatmap, eval=FALSE}
PlotHeat(object = output2, set = 'both', fontsize = 10,
          show_rownames = FALSE, show_colnames = FALSE)
```
